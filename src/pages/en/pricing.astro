---
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";

const pricingItems = [
    {
        categories: ["Therapy & Help", "Children & Youth", "Adults"],
        subcategory: "Counselling",
        title: "Initial Consultation",
        description:
            "Consultation with a Counsellor, Pedagogue, or Psychosocial Advisor. Crisis intervention.",
        duration: "50 min",
        price: 150, // Base in AUD
        tags: ["therapy", "consultation"],
        icon: "üëã",
    },
    {
        categories: ["Therapy & Help", "Forensic", "Adults"],
        subcategory: "Forensic",
        title: "Forensic Consultation",
        description:
            "Consultation with an Expert Witness. Analysis of litigation and family situation.",
        duration: "50 min",
        price: 220,
        tags: ["court", "consultation"],
        icon: "‚öñÔ∏è",
    },
    {
        categories: ["Therapy & Help", "Children & Youth", "Adults"],
        subcategory: "Counselling",
        title: "Individual Psychosocial Training",
        description:
            "Alternative to psychotherapy. We focus on concrete tools for coping with tension, worry, stress, and mood dips.",
        duration: "50 min",
        price: 150,
        tags: ["therapy", "individual", "counselling"],
        icon: "üß†",
    },
    {
        categories: ["Therapy & Help", "Children & Youth"],
        subcategory: "Development & Education",
        title: "Psychopedagogical Support for Children and Adolescents",
        description:
            "Educational meetings: emotion regulation, TKE-S, crisis support, parenting consultations.",
        duration: "50 min",
        price: 150,
        tags: ["children", "youth", "development"],
        icon: "üå±",
    },
    {
        categories: ["Therapy & Help", "Forensic", "Education"],
        subcategory: "Forensic / Education",
        title: "Correctional-Educational Session",
        description:
            "Implementation of court recommendations, improvement of parenting skills.",
        duration: "50 min",
        price: 230,
        tags: ["court", "education"],
        icon: "üéì",
    },
    {
        categories: ["Therapy & Help", "Children & Youth", "Adults"],
        subcategory: "Family",
        title: "Family Counselling / Mediation",
        description: "Family / Systemic Session. Conflict resolution.",
        duration: "50 min",
        price: 150,
        tags: ["family", "mediation"],
        icon: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶",
    },
    {
        categories: ["Therapy & Help", "Adults"],
        subcategory: "Couples",
        title: "Couples Relationship Training",
        description: "Work on communication and intimacy in the relationship.",
        duration: "50 min",
        price: 150,
        tags: ["couples", "relationship"],
        icon: "üíë",
    },
    {
        categories: ["Therapy & Help", "Adults", "Children & Youth"],
        subcategory: "Prevention",
        title: "Addiction Prevention",
        description: "Sobriety support. For voluntary applicants.",
        duration: "50 min",
        price: 150,
        tags: ["addiction", "prevention"],
        icon: "üõ°Ô∏è",
    },
    {
        categories: ["Therapy & Help", "Adults", "Online"],
        subcategory: "Online",
        title: "Online Session",
        description:
            "Counselling / E-visit. Full-value session via the internet.",
        duration: "50 min",
        price: 150,
        tags: ["online", "remote"],
        icon: "üíª",
    },
    {
        categories: ["Therapy & Help", "Adults", "Children & Youth"],
        subcategory: "Visit",
        title: "Home Visit",
        description:
            "Session in the client's environment (+ travel costs depending on location).",
        duration: "50 min",
        price: 300,
        pricePrefix: "from ",
        tags: ["home", "mobile"],
        icon: "üè†",
    },

    {
        categories: ["Dietetics", "Therapy & Help"],
        subcategory: "Consultation",
        title: "Psychodietetic Consultation",
        description: "Changing eating habits.",
        duration: "50 min",
        price: 130,
        tags: ["diet", "nutrition"],
        icon: "üçé",
    },
    {
        categories: ["Dietetics"],
        subcategory: "Plans",
        title: "Individual Nutrition Plans 1 Week",
        description: "Tailored to your needs and preferences.",
        duration: "1 Week",
        price: 80,
        tags: ["diet", "plan"],
        icon: "üìÖ",
    },
    {
        categories: ["Dietetics"],
        subcategory: "Plans",
        title: "Individual Nutrition Plans 2 Weeks",
        description: "Tailored to your needs and preferences.",
        duration: "2 Weeks",
        price: 150,
        tags: ["diet", "plan"],
        icon: "ü•ó",
    },
    {
        categories: ["Dietetics"],
        subcategory: "Plans",
        title: "Individual Nutrition Plans 4 Weeks",
        description: "Tailored to your needs and preferences.",
        duration: "4 Weeks",
        price: 300,
        tags: ["diet", "plan"],
        icon: "ü•ë",
    },
    {
        categories: ["Children & Youth", "Therapy & Help"],
        subcategory: "Groups",
        title: "TUS - Social Skills Training",
        description: "Group classes developing social skills.",
        duration: "60 min / week",
        price: 90,
        tags: ["children", "group", "tus"],
        icon: "üé≤",
    },
    {
        categories: ["Therapy & Help", "Adults"],
        subcategory: "Adults",
        title: "Support and Development Group",
        description: "Monthly subscription.",
        duration: "120 min / week",
        price: 450,
        tags: ["adults", "group"],
        icon: "üë•",
    },
    {
        categories: ["Forensic", "Education"],
        subcategory: "Documentation",
        title: "Certificate of Attendance",
        description:
            "Requires continuity of therapy (min 2 sessions). Completion time up to 3 business days.",
        duration: "Document",
        price: 230,
        tags: ["court", "certificate"],
        icon: "üìÑ",
    },
    {
        categories: ["Forensic"],
        subcategory: "Expertise",
        title: "Psychopedagogical Opinion",
        description:
            "Comprehensive opinion for Court or Institution. Private opinion only. Price depends on scope and number of sessions.",
        duration: "Extensive report",
        price: 3800,
        pricePrefix: "from ",
        tags: ["court", "opinion"],
        icon: "üìë",
    },
    {
        categories: ["Forensic"],
        subcategory: "Evidence",
        title: "Recording Transcription",
        description:
            "Converting audio/video recordings to text for evidentiary purposes.",
        duration: "Per hour of recording",
        price: 120,
        pricePrefix: "from ",
        tags: ["court", "evidence"],
        icon: "üìº",
    },
    {
        categories: ["Courses & Training", "Forensic"],
        subcategory: "Forensic",
        title: "Parenting Competence Course (Individual)",
        description:
            "10h classes with trainer, Exam, Certificate for Court, Supplement.",
        duration: "Individual",
        price: 2600,
        tags: ["course", "parents", "court"],
        icon: "üéì",
    },
    {
        categories: ["Courses & Training", "Forensic"],
        subcategory: "Forensic",
        title: "Parenting Competence Course (Group)",
        description:
            "10h classes with trainer, Exam, Certificate for Court, Supplement.",
        duration: "Group",
        price: 1100,
        tags: ["course", "parents", "court"],
        icon: "üè´",
    },
    {
        categories: ["Courses & Training", "Therapy & Help"],
        subcategory: "Couples",
        title: "Premarital / Couples Course",
        description: "10h classes, Certificate, communication workshops.",
        duration: "10h classes",
        price: 800,
        tags: ["course", "couples"],
        icon: "üíç",
    },
    {
        categories: ["Courses & Training", "Education"],
        subcategory: "Education",
        title: "Retake Exam",
        description: "Retaking the final course test.",
        duration: "Test",
        price: 260,
        tags: ["exam"],
        icon: "üìù",
    },
];

const filters = [
    { label: "All", value: "all" },
    { label: "Therapy & Help", value: "Therapy & Help" },
    { label: "Children & Youth", value: "Children & Youth" },
    { label: "Forensic", value: "Forensic" },
    { label: "Dietetics", value: "Dietetics" },
    { label: "Courses & Training", value: "Courses & Training" },
    { label: "Terms", value: "Terms" },
];
---

<Layout
    title="Price List | Psychosocial Support & Education | TPP"
    description="Check prices for counselling, family mediation, consultations, private opinions, and courses. Online services available."
    lang="en"
>
    <Header lang="en" />

    <main class="pricing-page">
        <section class="page-header">
            <div class="container">
                <h1>Support & Development Service Card</h1>
                <p class="subtitle">
                    Provided by the Support Center of the Psychopedagogical
                    Association
                </p>
                <p class="legal-note">
                    as part of paid public benefit activity (Journal of Laws
                    2024, item 1491)
                </p>
                <p class="date">Boles≈Çawiec ‚Äî valid from 01.01.2026</p>
            </div>
        </section>

        <div class="container">
            <div class="australian-notice">
                <p>
                    <strong>Important Note:</strong> Services provided in English
                    are offered by an Australian entity in full cooperation and accreditation
                    with the Psychopedagogical Association. Invoices are issued by
                    the Australian entity. Services in English are available <strong
                        >Online Only</strong
                    >.
                </p>
            </div>
        </div>

        <div class="container pricing-container">
            <!-- Currency Converter -->
            <div class="currency-bar">
                <span>Currency:</span>
                <div class="currency-toggles">
                    <button class="curr-btn active" data-currency="AUD"
                        >AUD</button
                    >
                    <button class="curr-btn" data-currency="USD">USD</button>
                    <button class="curr-btn" data-currency="CAD">CAD</button>
                </div>
            </div>

            <!-- Rules Panel -->
            <div class="rules-panel">
                <div class="rule-item">
                    <h3>Payment</h3>
                    <p>Cash, card, or PayPal. Payment before the session.</p>
                </div>
                <div class="rule-item">
                    <h3>Cancellation</h3>
                    <p>Free up to 24h before. Late cancellation: 50% fee.</p>
                </div>
                <div class="rule-item">
                    <h3>Location</h3>
                    <p>Online Only (for English services).</p>
                </div>
                <div class="rule-item">
                    <h3>Documentation</h3>
                    <p>Issued within 14 business days.</p>
                </div>
            </div>

            <!-- Search & Filter -->
            <div class="filter-section">
                <div class="search-box">
                    <input
                        type="text"
                        id="searchInput"
                        placeholder="What are you looking for? e.g. 'therapy', 'court', 'child'..."
                    />
                </div>

                <div class="filter-tabs">
                    {
                        filters.map((filter) => (
                            <button
                                class={`filter-btn ${filter.value === "all" ? "active" : ""}`}
                                data-filter={filter.value}
                            >
                                {filter.label}
                            </button>
                        ))
                    }
                </div>

                <p id="resultsCount" class="results-count" aria-live="polite">
                </p>
                <div id="noResults" class="no-results" hidden>
                    No results found. Try a different filter or search term.
                </div>
            </div>

            <!-- Pricing Categories -->
            <div id="pricing-grid" class="pricing-grid">
                {
                    pricingItems.map((item) => (
                        <div
                            class="pricing-card"
                            data-categories={JSON.stringify(item.categories)}
                            data-tags={item.tags.join(" ")}
                            data-title={item.title.toLowerCase()}
                            data-desc={item.description.toLowerCase()}
                            data-subcategory={item.subcategory.toLowerCase()}
                        >
                            <div class="card-header">
                                <div class="header-top">
                                    <span class="category-badge">
                                        {item.subcategory}
                                    </span>
                                    <span class="icon">{item.icon}</span>
                                </div>
                                <h3>{item.title}</h3>
                            </div>
                            <div class="card-body">
                                <p>{item.description}</p>
                            </div>
                            <div class="card-footer">
                                <span class="duration">{item.duration}</span>
                                <span class="price-container">
                                    <>
                                        <span class="prefix">
                                            {item.pricePrefix || ""}
                                        </span>
                                        <span
                                            class="price-val"
                                            data-base-price={item.price}
                                        >
                                            {item.price}
                                        </span>
                                        <span class="currency-symbol">
                                            {" "}
                                            AUD
                                        </span>
                                    </>
                                </span>
                            </div>
                        </div>
                    ))
                }
            </div>

            <!-- Legal Disclaimer -->
            <div class="disclaimer-alert">
                <p>
                    <strong>Important Legal Notice:</strong> This description is for
                    information purposes only. Services provided by the Association
                    are of educational, developmental, and supportive nature (counselling).
                    <br /><br />
                    <strong>They do not constitute healthcare services</strong> within
                    the meaning of the Medical Activity Act. In case of suspected
                    disorders requiring pharmacological treatment or hospitalization,
                    our specialists refer clients to healthcare facilities. By using
                    the Association's services, you accept this scope of cooperation.
                </p>
            </div>
        </div>

        <section class="cta-section">
            <div class="container">
                <h2>Ready for the first step?</h2>
                <p>Contact us to book a visit at a convenient time.</p>
                <a
                    href="https://rejestracja.psychopedagog.org/#/booking"
                    class="btn btn-primary btn-lg">Book online</a
                >
            </div>
        </section>
    </main>

    <Footer lang="en" />

    <script>
        // @ts-nocheck
        const searchInput = document.getElementById("searchInput");
        const filterBtns = document.querySelectorAll(".filter-btn");
        const currencyBtns = document.querySelectorAll(".curr-btn");
        const cards = document.querySelectorAll(".pricing-card");
        const resultsCount = document.getElementById("resultsCount");
        const noResults = document.getElementById("noResults");

        let currentFilter = "all";
        let searchQuery = "";

        // Currency Rates
        const rates = {
            AUD: 1,
            USD: 0.65,
            CAD: 0.9,
        };

        function niceRound(num) {
            if (num > 100) return Math.ceil(num / 10) * 10;
            return Math.ceil(num / 5) * 5;
        }

        function updateCurrency(currency) {
            const rate = rates[currency] || 1;
            const priceValues = document.querySelectorAll(".price-val");
            const currencySymbols =
                document.querySelectorAll(".currency-symbol");

            priceValues.forEach((el) => {
                const basePrice = parseFloat(el.dataset.basePrice || "0");
                const converted = niceRound(basePrice * rate);
                el.textContent = converted.toString();
            });

            currencySymbols.forEach((el) => {
                el.textContent = ` ${currency}`;
            });
        }

        currencyBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
                currencyBtns.forEach((b) => b.classList.remove("active"));
                btn.classList.add("active");
                const curr = btn.dataset.currency || "AUD";
                updateCurrency(curr);
            });
        });

        // Search & Filter Logic
        const normalize = (s) =>
            (s || "")
                .toLowerCase()
                .normalize("NFD")
                .replace(/[\u0300-\u036f]/g, "");

        function getCategories(el) {
            try {
                return JSON.parse(el.dataset.categories || "[]");
            } catch {
                return [];
            }
        }

        function filterItems() {
            let visible = 0;

            cards.forEach((card) => {
                const el = card;
                const categories = getCategories(el);
                const tags = normalize(el.dataset.tags);
                const title = normalize(el.dataset.title);
                const desc = normalize(el.dataset.desc);
                const subcategory = normalize(el.dataset.subcategory);
                const categoriesText = normalize(categories.join(" "));

                const q = normalize(searchQuery);
                const matchesFilter =
                    currentFilter === "all" ||
                    categories.includes(currentFilter);

                const matchesSearch =
                    q.length === 0 ||
                    title.includes(q) ||
                    tags.includes(q) ||
                    desc.includes(q) ||
                    subcategory.includes(q) ||
                    categoriesText.includes(q);

                const show = matchesFilter && matchesSearch;

                if (show) {
                    visible += 1;
                    el.classList.remove("is-hidden");
                } else {
                    el.classList.add("is-hidden");
                }
            });

            if (resultsCount) resultsCount.textContent = `Found: ${visible}`;
            if (noResults) noResults.hidden = visible !== 0;
        }

        filterItems();

        filterBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
                filterBtns.forEach((b) => b.classList.remove("active"));
                btn.classList.add("active");
                currentFilter = btn.dataset.filter || "all";
                filterItems();
            });
        });

        if (searchInput) {
            searchInput.addEventListener("input", (e) => {
                searchQuery = e.target.value || "";
                filterItems();
            });
        }
    </script>

    <style>
        .pricing-page {
            background-color: var(--color-bg-body);
            min-height: 100vh;
            padding-bottom: 4rem;
        }

        .page-header {
            background-color: var(--color-bg-alt);
            padding: 3rem 0;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .page-header h1 {
            font-size: 2rem;
            color: var(--color-primary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
        }

        .subtitle {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 0.2rem;
        }

        .legal-note {
            font-size: 0.9rem;
            color: var(--color-text-light);
            margin-bottom: 1rem;
        }

        .date {
            font-weight: 600;
        }

        .australian-notice {
            background-color: #e3f2fd;
            border: 1px solid #bbdefb;
            color: #0d47a1;
            padding: 1.5rem;
            border-radius: var(--radius-md);
            margin: 2rem 0 1rem 0;
            text-align: center;
            font-size: 1.05rem;
            box-shadow: var(--shadow-sm);
        }

        .australian-notice strong {
            font-weight: 700;
        }

        .disclaimer-alert {
            background: var(--color-bg-card);
            border-left: 4px solid var(--color-primary);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-sm);
            color: var(--color-text-light);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Currency Bar */
        .currency-bar {
            background: var(--color-bg-card);
            padding: 1rem;
            border-radius: var(--radius-full);
            box-shadow: var(--shadow-sm);
            margin-bottom: 2rem;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .currency-toggles {
            display: flex;
            gap: 0.5rem;
        }

        .curr-btn {
            background: var(--color-bg-alt);
            border: 1px solid #ddd;
            padding: 0.3rem 0.8rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 600;
            color: var(--color-text);
            transition: all 0.2s;
        }

        .curr-btn.active {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        /* Search & Filters */
        .filter-section {
            margin-bottom: 3rem;
        }

        .search-box {
            margin-bottom: 1.5rem;
        }

        .search-box input {
            width: 100%;
            padding: 1rem 1.5rem;
            background: var(--color-bg-card);
            border: 2px solid var(--color-bg-alt);
            border-radius: var(--radius-full);
            font-size: 1rem;
            transition: all 0.3s;
            outline: none;
        }

        .search-box input:focus {
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(220, 88, 42, 0.1);
        }

        .filter-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
        }

        .filter-btn {
            background: var(--color-bg-card);
            border: 1px solid #e0e0e0;
            padding: 0.5rem 1.2rem;
            border-radius: var(--radius-full);
            cursor: pointer;
            font-family: var(--font-body);
            font-weight: 500;
            color: var(--color-text);
            transition: all 0.2s;
        }

        .filter-btn:hover {
            background: var(--color-primary-light);
            border-color: var(--color-primary-light);
        }

        .filter-btn.active {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        /* Pricing Grid */
        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .pricing-card {
            background: var(--color-bg-card);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition:
                transform 0.3s,
                opacity 0.3s;
        }

        .pricing-card:hover {
            transform: translateY(-5px) !important;
            box-shadow: var(--shadow-md);
        }

        .card-header {
            margin-bottom: 1rem;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .category-badge {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--color-text-light);
            font-weight: 600;
            display: block;
        }

        .icon {
            font-size: 1.5rem;
            line-height: 1;
        }

        .card-header h3 {
            font-size: 1.25rem;
            color: var(--color-primary);
            margin: 0;
        }

        .card-body {
            flex-grow: 1;
            margin-bottom: 1.5rem;
        }

        .card-body p {
            color: var(--color-text);
            font-size: 0.95rem;
            line-height: 1.5;
            margin: 0;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #f0f0f0;
            padding-top: 1rem;
        }

        .duration {
            font-size: 0.9rem;
            color: var(--color-text-light);
            background: var(--color-bg-alt);
            padding: 0.2rem 0.6rem;
            border-radius: var(--radius-sm);
        }

        .price-container {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--color-text);
            display: flex;
            gap: 0.2rem;
        }

        .custom-price {
            font-size: 1rem;
            color: var(--color-primary);
        }

        /* CTA */
        .cta-section {
            background: var(--color-primary);
            color: white;
            text-align: center;
            padding: 3rem 0;
            margin-top: 3rem;
            border-radius: var(--radius-lg);
        }

        .cta-section h2 {
            color: white;
            margin-bottom: 0.5rem;
        }

        .cta-section p {
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }

        .btn-lg {
            background: white;
            color: var(--color-primary);
            padding: 0.8rem 2rem;
            font-weight: 600;
        }

        .rules-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--color-bg-alt);
            border-radius: var(--radius-md);
            text-align: center;
        }

        .rule-item h3 {
            font-size: 1.1rem;
            color: var(--color-primary);
            margin-bottom: 0.5rem;
        }

        .rule-item p {
            font-size: 0.9rem;
            color: var(--color-text);
            margin: 0;
        }

        .pricing-card.is-hidden {
            display: none !important;
        }

        .results-count {
            margin: 0.5rem 0 1rem;
            color: var(--color-text-light);
            text-align: center;
            font-weight: 600;
        }

        .no-results {
            text-align: center;
            padding: 1rem;
            border-radius: var(--radius-md);
            background: var(--color-bg-card);
            box-shadow: var(--shadow-sm);
            color: var(--color-text);
            margin-bottom: 1rem;
        }
    </style>
</Layout>
